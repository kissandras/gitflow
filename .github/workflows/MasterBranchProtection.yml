name: Master Branch Protection

on:
  pull_request:
    branches: [ master ]

jobs:
  check-source-branch:
    runs-on: ubuntu-latest
    steps:
      - name: Check source branch
        run: |
          source_branch="${{ github.head_ref }}"
          echo "Source branch: $source_branch"
          
          if [[ "$source_branch" =~ ^(release|hotfix/.*)$ ]]; then
            echo "✅ Merge from $source_branch is allowed"
          else
            echo "❌ Merges to master are only allowed from 'release' or 'hotfix/*' branches"
            echo "Current source branch: $source_branch"
            exit 1
          fi
